var LhqGenerators;(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e){return null==e||""===e}function r(e,t="asc"){return Object.fromEntries(Object.entries(e).sort((([e],[n])=>"asc"===t?e.localeCompare(n,"en"):n.localeCompare(e,"en"))))}function s(e,t,n="asc"){return e.concat([]).sort(((e,r)=>{const s=void 0===t?e:e[t],o=void 0===t?r:r[t],a=s>o?1:o>s?-1:0;return"asc"===n?a:-1*a}))}function o(e,t){const n=Object.entries(e);if(n.length>0){const e=n.length-1;let r=-1;for(const[s,o]of n)r++,t(o,s,r,r==e)}}e.r(t),e.d(t,{TemplateManager:()=>R});const a={html:{">":"&gt;","<":"&lt;",'"':"&quot;","'":"&apos;","&":"&amp;"},xml:{">":"&gt;","<":"&lt;","&":"&amp;"},xml_quotes:{">":"&gt;","<":"&lt;",'"':"&quot;","'":"&apos;","&":"&amp;"},json:{"\\":"\\\\",'"':'\\"',"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"}};function i(e){switch(typeof e){case"boolean":return e;case"number":return e>0;case"string":return"true"===e.toLowerCase();default:return!1}}function l(e){return u(e)>0}function u(e){return n(e)?0:Array.isArray(e)?e.length:"object"==typeof e?Object.keys(e).length:0}class d{static addResultFile(e,t){HostAddResultFile?HostAddResultFile(e,t):console.log(`Added file '${e}' with content: '${t}'`)}static debugLog(e){HostDebugLog?HostDebugLog(e):console.log(e)}static pathCombine(e,t){return HostPathCombine?HostPathCombine(e,t):e+"/"+t}static webHtmlEncode(e){return HostWebHtmlEncode?HostWebHtmlEncode(e):e}static stopwatchStart(){return HostStopwatchStart?HostStopwatchStart():Date.now()}static stopwatchEnd(e){return HostStopwatchEnd?HostStopwatchEnd(e):(Date.now()-e).toString()}}const c={"x-header":function(){return"//------------------------------------------------------------------------------\n// <auto-generated>\n//     This code was generated by a tool - Localization HQ Editor.\n//\n//     Changes to this file may cause incorrect behavior and will be lost if\n//     the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------"},"x-value":function(e,t){const n=function(e,t){return t.split(".").reduce(((e,t)=>{if(void 0===e)return;const n=t.match(/^(\w+)\[(\d+)]$/);if(n){const[,t,r]=n;return Array.isArray(e[t])?e[t][r]:void 0}return e[t]}),e)}(e,t);return void 0!==n?n:""},"x-indent":function(e,t){return e=e<0?0:e,t.fn(this).split("\n").map((t=>"\t".repeat(e)+t)).join("\n")},"x-join":function(e,t){var n=t.hash.delimiter||",",r=t.hash.start||0,s=e?e.length:0,o=t.hash.end||s,a="",i=t.hash.decorator||'"';if(o>s&&(o=s),"function"==typeof t){for(let s=r;s<o;s++)s>r&&(a+=n),"string"==typeof e[s]?a+=e[s]:a+=t(e[s]);return a}var l=[].concat(e).map((e=>`${i}${e}${i}`)).slice(r,o).join(n);return new Handlebars.SafeString(l)},"x-concat":function(...e){const t=e.pop(),r=t.hash.sep||"";return function(t){var s;const o=e.filter((e=>!n(e))).join(r),a=null===(s=null==t?void 0:t.hash)||void 0===s?void 0:s.var;return n(a)||(p[a]=o),o}(t)},"x-replace":function(e,t){const n=t.hash.what||"",r=t.hash.with||"";if(!n||!r||n===r)return e;const s=new RegExp(n,"g");return e.replace(s,r)},"x-trimEnd":function(e,t){try{const n=new RegExp(t+"$");return e.replace(n,"")}catch(n){return console.error("Invalid regex pattern:",t),e}},"x-equals":function(e,t,n){const{cs:r,val1:s,val2:o}=function(e,t,n){var r,s;return{cs:"true"==(n.hash.cs||"true").toString().toLowerCase(),val1:"string"==typeof e?e:null!==(r=null==e?void 0:e.toString())&&void 0!==r?r:"",val2:"string"==typeof t?t:null!==(s=null==t?void 0:t.toString())&&void 0!==s?s:""}}(e,t,n);return r?s===o:s.toLowerCase()===o.toLowerCase()},"x-isTrue":function(e){return!0===e},"x-isFalse":function(e){return!1===e},"x-resourceComment":function(e,t){var r,s,o;if("object"==typeof e){const a=t.hash.root.model,i=null!==(s=null===(r=null==a?void 0:a.model)||void 0===r?void 0:r.primaryLanguage)&&void 0!==s?s:"";if(!n(i)&&e.values){const t=null===(o=e.values[i])||void 0===o?void 0:o.value;let r=n(t)?e.description:t;return r=function(e){if(n(e))return"";let t=!1;var r=e.indexOf("\r\n");return-1==r&&(r=e.indexOf("\n")),-1==r&&(r=e.indexOf("\r")),r>-1&&(e=e.substring(0,r),t=!0),e.length>80&&(e=e.substring(0,80),t=!0),t&&(e+="..."),e.replace("\t"," ")}(r),new Handlebars.SafeString(r)}}return""},"x-resourceValue":function(e,t){var r,s,o,a,i;if("object"==typeof e){const l=null!==(r=t.hash.lang)&&void 0!==r?r:"",u=null!==(s=t.hash.trim)&&void 0!==s&&s;if(!n(l)){const t=null!==(i=null===(a=null===(o=null==e?void 0:e.values)||void 0===o?void 0:o[l])||void 0===a?void 0:a.value)&&void 0!==i?i:"";return u?t.trim():t}}return""},"x-resourceHasLang":function(e,t){var r;if("object"==typeof e){const s=null!==(r=t.hash.lang)&&void 0!==r?r:"";if(!n(s)&&e.values&&e.values[s])return!0}return!1},"x-resourceParamNames":function(e,t){var n,r;if("object"==typeof e&&e.parameters){const s=null!==(r=null===(n=null==t?void 0:t.hash)||void 0===n?void 0:n.withTypes)&&void 0!==r&&r;return Object.keys(e.parameters).map((e=>s?`object ${e}`:e)).join(",")}return""},"x-merge":function(e,t){var n;return Object.assign({},e,null!==(n=t.hash)&&void 0!==n?n:{})},"x-sortBy":function(e,t,n="asc"){return s(e,t,n)},"x-sortObject":function(e,t){var n,s;return r(e,null!==(s=null===(n=null==t?void 0:t.hash)||void 0===n?void 0:n.sortOrder)&&void 0!==s?s:"asc")},"x-objCount":function(e){return u(e)},"x-hasItems":function(e){return l(e)},"x-textEncode":function(e,t){var r,s,o,i;const l=function(e,t){var r;if(n(e))return e;const s=[];for(let n=0;n<e.length;n++){const o=e.charAt(n);let i;i="html"===t.mode?a.html:"xml"===t.mode?null===(r=t.quotes)||void 0===r||r?a.xml_quotes:a.xml:a.json,i.hasOwnProperty(o)?s.push(i[o]):s.push(o)}return s.join("")}(e,{mode:null!==(s=null===(r=null==t?void 0:t.hash)||void 0===r?void 0:r.mode)&&void 0!==s?s:"html",quotes:null!==(i=null===(o=null==t?void 0:t.hash)||void 0===o?void 0:o.quotes)&&void 0!==i&&i});return new Handlebars.SafeString(l)},"x-host-webHtmlEncode":function(e){if(n(e))return e;const t=d.webHtmlEncode(e);return new Handlebars.SafeString(t)},"x-render":function(e,t){var n,r;return null===(r=null===(n=null==t?void 0:t.hash)||void 0===n?void 0:n.when)||void 0===r||r?e:""},"x-isNullOrEmpty":function(e){return n(e)},"x-isNotNullOrEmpty":function(e){return!n(e)},"x-fn":function(e,...t){let n;return arguments.length>0&&(n=Array.from(t).slice(0,-1)),void 0===n?e():e(...n)},"x-logical":function(e,t,n){const r=(n.hash.op||"and").toLowerCase();return"and"===r?!0===e&&!0===t:"or"===r&&(!0===e||!0===t)},"x-debugLog":function(...e){return d.debugLog(e.join(" ")),""},"x-var":function(e,t){var r,s;const o=null===(r=null==t?void 0:t.hash)||void 0===r?void 0:r.default;return n(e)?"":null!==(s=p[e])&&void 0!==s?s:o}};let h=0,p={},g={};const m=!1;function f(){h=0,p={}}function v(e){const t=Math.floor(e/1e3),n=e%1e3;return t>0?`${t} second${t>1?"s":""} and ${n} ms`:`${n} ms`}class b{constructor(e){this.handlebarFiles=e}getHandlebarFile(e){const t=this.handlebarFiles[e];if(void 0===t||""===t)throw new Error(`Handlebar file with name '${e}' not found !`);return t}prepareFilePath(e,t){const r=t.OutputFolder;return n(r)?e:d.pathCombine(r,e)}compileAndRun(e,t){let r;if(void 0===this.lastCompiledTemplate||this.lastCompiledTemplate.templateFileName.toLowerCase()!==e.toLowerCase()){const t=this.getHandlebarFile(e),n={knownHelpers:Object.fromEntries(Object.keys(c).map((e=>[e,!0])))};r=Handlebars.compile(t,n),this.lastCompiledTemplate={templateFileName:e,compiled:r}}else r=this.lastCompiledTemplate.compiled;if(n(r))throw new Error(`Template '${e}' was not found !`);f();let s=r(t);return s=s.replace(/\tÂ¤$/gm,""),s}}class x extends b{generate(e){var t;const r=e.model.model,o=r.name;if(this._settings.Typescript.Enabled.isTrue()){const t=this.compileAndRun(x.Id,e),n=this.prepareFilePath(o+".d.ts",this._settings.Typescript);d.addResultFile(n,t)}if(this._settings.Json.Enabled.isTrue()){const a=function(e,t){let r=n(e)?t:e;return r}(this._settings.Json.MetadataFileNameSuffix,"metadata"),i={default:r.primaryLanguage,languages:s(e.model.languages,void 0,"asc")},l=JSON.stringify(i,null,"\t")+"\n",u=this.prepareFilePath(`${o}-${a}.json`,this._settings.Json);d.addResultFile(u,l),e.extra={};const c=this._settings.Json.WriteEmptyValues.isTrue(),h=this._settings.Json.CultureCodeInFileNameForPrimaryLanguage.isTrue();null===(t=e.model.languages)||void 0===t||t.forEach((t=>{if(!n(t)){const n=r.primaryLanguage!==t||h?`.${t}`:"";e.extra.lang=t,e.extra.writeEmptyValues=c;const s=this.compileAndRun("JsonPerLanguage",e),a=this.prepareFilePath(`${o}${n}.json`,this._settings.Json);d.addResultFile(a,s)}}))}}loadSettings(e){var t,n,r;const s={Typescript:void 0,Json:void 0};if(null===(t=e.childs)||void 0===t||t.forEach((e=>{const t=e.attrs;switch(e.name){case"Typescript":s.Typescript=t;break;case"Json":s.Json=t}})),void 0===s.Typescript)throw new Error("Typescript settings not found !");if(void 0===s.Json)throw new Error("Json settings not found !");return s.Typescript.Enabled=null!==(n=s.Typescript.Enabled)&&void 0!==n?n:(!0).toString(),s.Json.Enabled=null!==(r=s.Json.Enabled)&&void 0!==r?r:(!0).toString(),this._settings=s,s}static get Id(){return"TypescriptJson01"}}class S extends Error{constructor(e,t,n){super(t),this.title=e,this.message=t,this.name="AppError",Error.captureStackTrace&&Error.captureStackTrace(this,S),null!=n&&(this.stack=n)}}class C extends b{constructor(e){super(e)}checkHasNamespaceName(e){const t="namespace";if(n(e.host[t]))throw new S(`Missing value for parameter '${t}'.`,`> provide valid path to *.csproj which uses required lhq model\n> or provide value for parameter '${t}' in cmd data parameters`)}debugLog(e){d.debugLog(e)}generate(e){var t,r;const s=e.model.model.version<2,o=e.model.model.name;if(e.extra=null!==(t=e.extra)&&void 0!==t?t:{},this._settings.CSharp.Enabled.isTrue()){this.checkHasNamespaceName(e),e.extra.rootClassName=this.getRootCsharpClassName(e);const t=this.compileAndRun(this.csharpTemplateName,e),n=this.prepareFilePath(o+".gen.cs",this._settings.CSharp);d.addResultFile(n,t)}this._settings.ResX.Enabled.isTrue()&&(e.extra.useHostWebHtmlEncode=n(this._settings.ResX.CompatibleTextEncoding)?s:this._settings.ResX.CompatibleTextEncoding.isTrue(),null===(r=e.model.languages)||void 0===r||r.forEach((t=>{if(!n(t)){e.extra.lang=t;const n=this.compileAndRun("SharedResx",e),r=this.prepareFilePath(`${o}.${t}.resx`,this._settings.ResX);d.addResultFile(r,n)}})))}loadSettings(e){var t,n,r;const s={CSharp:void 0,ResX:void 0};if(null===(t=e.childs)||void 0===t||t.forEach((e=>{const t=e.attrs;switch(e.name){case"CSharp":s.CSharp=t;break;case"ResX":s.ResX=t}})),void 0===s.CSharp)throw new Error("CSharp settings not found !");if(void 0===s.ResX)throw new Error("ResX settings not found !");return s.CSharp.Enabled=null!==(n=s.CSharp.Enabled)&&void 0!==n?n:(!0).toString(),s.ResX.Enabled=null!==(r=s.ResX.Enabled)&&void 0!==r?r:(!0).toString(),this._settings=s,s}}class w extends C{static get Id(){return"NetCoreResxCsharp01"}get csharpTemplateName(){return w.Id}getRootCsharpClassName(e){return e.model.model.name+"Localizer"}}class y extends C{static get Id(){return"WpfResxCsharp01"}get csharpTemplateName(){return y.Id}getRootCsharpClassName(e){return e.model.model.name+"Context"}}class E extends C{static get Id(){return"WinFormsResxCsharp01"}get csharpTemplateName(){return E.Id}getRootCsharpClassName(e){return e.model.model.name+"Context"}loadSettings(e){var t,n,r;const s=super.loadSettings(e);return s.CSharp.ParamsMethodsSuffix=null!==(t=s.CSharp.ParamsMethodsSuffix)&&void 0!==t?t:"WithParams",s.CSharp.GenerateParamsMethods=null!==(n=s.CSharp.GenerateParamsMethods)&&void 0!==n?n:(!0).toString(),s.CSharp.MissingTranslationFallbackToPrimary=null!==(r=s.CSharp.MissingTranslationFallbackToPrimary)&&void 0!==r?r:(!1).toString(),s}generate(e){var t,n;if(this._settings.CSharp.Enabled.isTrue()){e.extra=null!==(t=e.extra)&&void 0!==t?t:{};const r=this._settings.CSharp.GenerateParamsMethods.isTrue();e.extra.generateParamsMethods=r,e.extra.paramsMethodsSuffix=r?null!==(n=this._settings.CSharp.ParamsMethodsSuffix)&&void 0!==n?n:"WithParams":"";const s=this.prepareFilePath("BindableObject.gen.cs",this._settings.CSharp),o=this.compileAndRun("WinFormsBindableObject",e);d.addResultFile(s,o)}super.generate(e)}}class T extends C{static get Id(){return"WpfResxCsharp01"}get csharpTemplateName(){return T.Id}getRootCsharpClassName(e){return e.model.model.name+"Context"}}class R{static intialize(e){R.handlebarFiles=JSON.parse(e),String.prototype.isTrue=function(){return"true"===this.toLowerCase()},function(){Object.keys(c).forEach((e=>{const t=c[e];Handlebars.registerHelper(e,(()=>function(e,t,...n){var r,s,o,a,l,u;let c=!1,p="",f=0;if(arguments.length>0){const e=arguments[arguments.length-1];if(c=i(null!==(s=null===(r=e.hash)||void 0===r?void 0:r._debug)&&void 0!==s&&s),c){f=++h;const t=(null!==(a=null===(o=e.hash)||void 0===o?void 0:o._debugLog)&&void 0!==a?a:"").toString(),r=(v=null!==(l=e.hash)&&void 0!==l?l:{},b=["_debug","_debugLog"],Object.fromEntries(Object.entries(v).filter((([e])=>!b.includes(e))))),s=Array.from(n).slice(0,-1);p=`[${f}#${e.name}](${t}) hash: ${JSON.stringify(r,null,0)}`,d.debugLog(`${p} ${JSON.stringify(s,null,0)}`)}}var v,b;let x=0;m&&(x=Date.now());const S=t.call(this,...n);if(m){const t=Date.now()-x;g[e]=(null!==(u=g[e])&&void 0!==u?u:0)+t}return c&&d.debugLog(`${p}, result: ${JSON.stringify(S,null,0)}`),S}(e,t,...arguments)))})),f()}()}static runTemplate(e,t){let n=JSON.parse(e);if(!n)throw new Error("Unable to deserialize LHQ model !");{n=R.sortByNameModel(n);const{template:e,templateId:r,settingsNode:s}=R.loadTemplate(n);let o=e.loadSettings(s),a={};t&&(a=JSON.parse(t));const i={model:n,settings:o,host:a,extra:{}};e.generate(i),function(){if(!m)return;let e=0;Object.keys(g).forEach((t=>{var n;const r=null!==(n=g[t])&&void 0!==n?n:0;e+=r,d.debugLog(`helper '${t}' taken total: ${v(r)}`)})),d.debugLog(`All helpers taken total: ${v(e)}`)}(),f()}}static loadTemplate(e){var t,n,r;let s,o="",a=null===(n=null===(t=e.metadatas)||void 0===t?void 0:t.childs)||void 0===n?void 0:n.find((e=>{var t;return"metadata"===e.name&&"b40c8a1d-23b7-4f78-991b-c24898596dd2"===(null===(t=e.attrs)||void 0===t?void 0:t.descriptorUID)}));if(a&&(a=null===(r=a.childs)||void 0===r?void 0:r.find((e=>{var t;return"content"===e.name&&void 0!==(null===(t=e.attrs)||void 0===t?void 0:t.templateId)})),a&&(o=null==a?void 0:a.attrs.templateId,a=a.childs.find((e=>{var t;return"Settings"===e.name&&(null===(t=e.childs)||void 0===t?void 0:t.length)>0})))),a&&void 0!==o&&""!==s){const e=R.generators[o];return s=e&&new e(R.handlebarFiles)||void 0,{template:s,templateId:o,settingsNode:a}}throw new Error(`Template '${o}' not found !`)}static sortByNameModel(e){function t(e,t){let n=[],r=t.getParent();for(n.unshift(t.getName());r&&!(null==r?void 0:r.isRoot());)n.unshift(r.getName()),r=r.getParent();return n.join(e)}return e.getName=()=>e.model.name,e.isRoot=()=>!0,e.isLast=()=>!0,e.getParent=()=>{},e.hasCategories=()=>l(e.categories),e.hasResources=()=>l(e.resources),e.getFullParentPath=()=>"",function e(n){n.categories&&(n.categories=r(n.categories),o(n.categories,((r,s,o,a)=>{r.getName=()=>s,r.isRoot=()=>!1,r.isLast=()=>a,r.getParent=()=>n,r.hasCategories=()=>l(n.categories),r.hasResources=()=>l(n.resources),r.getFullParentPath=e=>t(e,r),e(r)}))),n.resources&&(n.resources=r(n.resources),o(n.resources,((e,r,s,a)=>{e.getName=()=>r,e.isLast=()=>a,e.getParent=()=>n,e.hasParameters=()=>l(e.parameters),e.getFullParentPath=n=>t(n,e),e.parameters&&(e.parameters=function(e,t,n="asc"){return Object.fromEntries(Object.entries(e).sort((([,e],[,r])=>{const s=t(e),o=t(r);return s<o?"asc"===n?-1:1:s>o?"asc"===n?1:-1:0})))}(e.parameters,(e=>e.order)),o(e.parameters,((t,n,r,s)=>{t.isLast=()=>s,t.getParent=()=>e})))})))}(e),e}}R.generators={[x.Id]:x,[w.Id]:w,[y.Id]:y,[E.Id]:E,[T.Id]:T},LhqGenerators=t})();